extends ../layout

block content
  .container
    .row.justify-content-center
      .col-12.col-md-10
        .card.shadow-sm.dark-surface
          .card-body.dark-card-body
            .d-flex.justify-content-between.align-items-center.mb-3
              h4.mb-0.text-white Services List
              .btn-group
                a.btn.btn-outline-light-custom.btn-sm(href='/books/new')
                  i.bi.bi-plus-lg.me-1
                  | Create New Service
                a.btn.btn-outline-light-custom.btn-sm(href='/orders/new')
                  | Orders Page
            p.text-muted-light.small.mb-3 Use this page to review and delete created services.

            .table-responsive
              table.table.table-hover.table-sm#booksTable
                thead
                  tr
                    th Name
                    th.text-end Unit Price
                    th.text-center Created
                    th.text-center Actions
                tbody
                  if books && books.length
                    each b in books
                      tr.book-row(data-id=b._id)
                        td #{b.name}
                        td.text-end GHâ‚µ #{(b.unitPrice || 0).toFixed(2)}
                        td.text-center #{b.createdAt ? (new Date(b.createdAt)).toLocaleString() : ''}
                        td.text-center
                          button.btn.btn-sm.btn-outline-light-custom.preview-book-btn(
                            type='button',
                            data-id=b._id
                          ) Preview
                          a.btn.btn-sm.btn-primary.ms-1(
                            href=`/books/new?id=${b._id}`
                          ) Edit
                          button.btn.btn-sm.btn-outline-danger.ms-1.delete-book-btn(
                            type='button',
                            data-id=b._id
                          ) Delete
                      // placeholder for expanded preview (inserted by client)
                      tr.book-preview-row(data-id=b._id style='display:none')
                        td(colspan='4')
                          .book-preview-container.dark-card-body

                  else
                    tr
                      td.text-muted-light(colspan='4') No service created yet.

  .mt-3.text-muted-light.small
    | Deleting a service will not affect existing orders. Use with care.
  // Keep Books list scripts inside #main-content so dashboard_nav AJAX loads them
  script(src='/javascripts/books_list_client.js')
