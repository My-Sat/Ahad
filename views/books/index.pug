extends ../layout

block content
  .container
    .row.justify-content-center
      .col-12.col-md-10
        .card.shadow-sm
          .card-body
            .d-flex.justify-content-between.align-items-center.mb-3
              h4.mb-0 Books
              .btn-group
                a.btn.btn-outline-primary.btn-sm(href='/books/new')
                  i.bi.bi-plus-lg.me-1
                  | Create book
                a.btn.btn-outline-secondary.btn-sm(href='/orders/new')
                  | Orders Page
            p.text-muted.small.mb-3 Use this page to review and delete created books.

            .table-responsive
              table.table.table-hover.table-sm#booksTable
                thead
                  tr
                    th Name
                    th.text-end Unit Price
                    th.text-center Created
                    th.text-center Actions
                tbody
                  if books && books.length
                    each b in books
                      tr.book-row(data-id=b._id)
                        td #{b.name}
                        td.text-end GHâ‚µ #{(b.unitPrice || 0).toFixed(2)}
                        td.text-center #{b.createdAt ? (new Date(b.createdAt)).toLocaleString() : ''}
                        td.text-center
                          button.btn.btn-sm.btn-outline-secondary.preview-book-btn(type='button' data-id=b._id) Preview
                          button.btn.btn-sm.btn-outline-danger.delete-book-btn(type='button', data-id=b._id) Delete
                      // placeholder for expanded preview (inserted by client)
                      tr.book-preview-row(data-id=b._id style='display:none')
                        td(colspan='4')
                          .book-preview-container
                  else
                    tr
                      td.text-muted(colspan='4') No books created yet.

  .mt-3.text-muted.small
    | Deleting a book will not affect existing orders. Use with care.

block append scripts
  script(src='/public/javascripts/books_list_client.js')
